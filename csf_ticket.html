<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta property="og:title" content="Cubs Sports Fest Ticket">
  <meta property="og:description" content="Entry Ticket for Cups Sports Fest">
  <title>Cubs Sports Fest Ticket</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap');

    :root {
      --ticket-width: 800px;
    }

    body {
      font-family: 'Nunito', sans-serif;
      background-color: #ecf7f0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 10px;
      flex-direction: column;
    }

    .ticket-wrapper {
      position: relative;
      width: 100%;
      max-width: var(--ticket-width);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
      border-radius: 24px;
      overflow: hidden;
    }

    /* The Ticket Image */
    .ticket-bg {
      width: 100%;
      display: block;
      height: auto;
    }

    /* Overlay Container for Text */
    .ticket-details {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      color: #333;
    }

    /* CENTER SECTION - Child, Parent, Mobile */
    .section-center {
      position: absolute;
      top: 24%;
      left: 55%;
      transform: translateX(-50%);
      text-align: center;
      width: 44%;
      /* Slightly wider to prevent wrap */
    }

    .child-name {
      font-size: 1.6rem;
      font-weight: 900;
      color: #287844;
      margin-bottom: 2px;
      text-transform: uppercase;
      line-height: 1.1;
    }

    .parent-details {
      font-size: 0.9rem;
      font-weight: 700;
      color: #111111;
      /* Proper dark color */
      background: rgba(255, 255, 255, 0.25);
      /* Very transparent */
      padding: 4px 12px;
      border-radius: 10px;
      display: inline-block;
      line-height: 1.3;
      backdrop-filter: blur(1px);
      /* Reduced blur slightly */
    }

    /* RIGHT SECTION - Time, Batch, QR */
    .section-right {
      position: absolute;
      top: 34%;
      /* Up 1% (was 35%) */
      right: -5%;
      width: 25%;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .meta-details {
      margin-bottom: 8px;
      line-height: 1.2;
      color: #287844;
    }

    .batch-name {
      font-size: 1.1rem;
      font-weight: 900;
      display: block;
      margin-bottom: 6px;
      /* Added spacing per request */
    }

    .time-val {
      font-size: 0.65rem;
      /* Smaller (was 0.85rem) */
      font-weight: 700;
      display: block;
      color: #333;
      /* Darker for better visibility */
      white-space: nowrap;
      /* Prevent wrapping */
    }

    .row-id {
      font-size: 0.7rem;
      font-weight: 800;
      color: #888;
      margin-top: 2px;
      display: block;
    }

    .qr-code {
      width: 85px;
      height: 85px;
      border: 3px solid white;
      border-radius: 8px;
    }

    /* Download Button */
    .actions {
      margin-top: 25px;
      text-align: center;
    }

    .btn-download {
      background: #287844;
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 50px;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(40, 120, 68, 0.3);
      transition: transform 0.2s;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
    }

    .btn-download:active {
      transform: scale(0.95);
    }

    /* --- FLOATING CHARACTERS (Decorative) --- */
    .jungle-scene {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      pointer-events: none;
      overflow: hidden;
    }

    .char {
      position: absolute;
      width: 120px;
      opacity: 0.8;
      animation: float 6s ease-in-out infinite;
    }

    .c1 {
      top: 10%;
      left: 5%;
    }

    .c2 {
      bottom: 10%;
      right: 5%;
      animation-delay: 1s;
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0);
      }

      50% {
        transform: translateY(-15px);
      }
    }

    /* --- RESPONSIVE FIXES --- */
    @media (max-width: 600px) {

      /* Scale text down on mobile */
      html {
        font-size: 12px;
      }

      .child-name {
        font-size: 1.8rem;
        /* Relative to new base, so ~21px */
      }

      .ticket-wrapper {
        border-radius: 12px;
      }

      .btn-download {
        font-size: 1.2rem;
        padding: 10px 25px;
      }

      .qr-code {
        width: 60px;
        height: 60px;
        border-width: 2px;
      }

      /* Adjust floaters for mobile */
      .char {
        width: 80px;
      }

      .c1 {
        top: 5%;
        left: -5%;
      }

      .c2 {
        bottom: 5%;
        right: -5%;
      }
    }

    @media (max-width: 380px) {
      html {
        font-size: 10px;
      }
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>

<body>

  <div class="jungle-scene">
    <img src="https://i.postimg.cc/P5f3PB9b/Monkey_climbing_cam2.webp" class="char c1" alt="Cub 1">
    <img src="https://i.postimg.cc/mgZXt0Jy/Yoga_poses_for_work_monkey.webp" class="char c2" alt="Cub 2">
  </div>

  <div class="ticket-wrapper" id="ticketArea">
    <!-- background image -->
    <img src="CSF TICKET FORMAT.jpg" alt="Ticket Background" class="ticket-bg">

    <div class="ticket-details">

      <!-- Center Section -->
      <div class="section-center">
        <div class="child-name" id="childName">Super Cub</div>
        <div class="parent-details">
          <div id="parentName">Parent</div>
          <div id="mobile" style="font-size: 0.9em; margin-top: 2px;">+91 9876543210</div>
        </div>
      </div>

      <!-- Right Section -->
      <div class="section-right">
        <div class="meta-details">
          <span class="batch-name" id="batch">Morning</span>
          <span class="time-val" id="time">08:00 AM</span>
          <span class="row-id" id="rowId">#001</span>
        </div>
        <!-- QR Code -->
        <img id="qrImg" src="" class="qr-code" alt="QR">
      </div>

    </div>
  </div>

  <div class="actions">
    <button class="btn-download" onclick="downloadTicket()">
      ðŸ“¥ Download Ticket
    </button>
  </div>

  <script>
    // 1. Get URL Parameters
    const params = new URLSearchParams(window.location.search);
    const childName = params.get('name') || 'Super Cub';
    const parentName = params.get('parent') || 'Parent Name';
    const mobile = params.get('mobile') || '9876543210';
    let batch = params.get('batch') || 'Morning';
    const rowId = params.get('id') || '001';

    // Cleanup Batch Name (Remove 'Batch' if present to save space)
    batch = batch.replace(/Batch/i, '').trim();

    // Deduce Time based on Batch
    let timeDisplay = "Time: TBA";
    if (batch.toLowerCase().includes('morning')) {
      timeDisplay = "08:15 AM - 11:15 AM";
    } else if (batch.toLowerCase().includes('afternoon') || batch.toLowerCase().includes('mid')) {
      timeDisplay = "11:45 AM - 02:45 PM";
    } else if (batch.toLowerCase().includes('evening')) {
      timeDisplay = "03:15 PM - 06:15 PM";
    }

    // 2. Update UI
    document.getElementById('childName').textContent = childName;
    document.getElementById('parentName').textContent = parentName;
    document.getElementById('mobile').textContent = mobile;
    document.getElementById('batch').textContent = batch;
    document.getElementById('time').textContent = timeDisplay;
    document.getElementById('rowId').textContent = 'ID: #' + rowId;

    // 3. Generate QR Code
    const qrText = `âœ… VALID TICKET\n------------------\nChild: ${childName}\nParent: ${parentName}\nMobile: ${mobile}\nBatch: ${batch}\nTime: ${timeDisplay}\nID: ${rowId}`;
    document.getElementById('qrImg').src = `https://quickchart.io/qr?text=${encodeURIComponent(qrText)}&size=300&dark=000&ecLevel=M&margin=1`;

    // 4. Download Function
    function downloadTicket() {
      const ticketElement = document.getElementById('ticketArea');
      const btn = document.querySelector('.btn-download');

      btn.textContent = "Generating...";

      html2canvas(ticketElement, {
        scale: 2, // High resolution
        useCORS: true, // Allow loading remote images
        backgroundColor: null
      }).then(canvas => {
        const link = document.createElement('a');
        link.download = `CSF_Ticket_${childName.replace(/\s+/g, '_')}.png`;
        link.href = canvas.toDataURL('image/png');
        link.click();
        btn.textContent = "ðŸ“¥ Download Ticket";
      }).catch(err => {
        console.error(err);
        alert("Oops! Could not generate image. Please try taking a screenshot.");
        btn.textContent = "ðŸ“¥ Download Ticket";
      });
    }

  </script>
</body>

</html>