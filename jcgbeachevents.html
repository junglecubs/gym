<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Jungle Cubs Beach Events — Registration</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
      background: #f5f7fa; line-height: 1.5; min-height: 100vh;
      display: flex; align-items: center; justify-content: center; padding: 1rem;
    }
    .box {
      background: #fff; padding: 1.5rem; border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,.08); max-width: 860px; width: 100%;
    }
    h1 { color: #28a745; font-size: 1.6rem; margin-bottom: .75rem; font-weight: 800; text-align: center; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    label { font-weight: 600; color: #333; display: block; margin-top: .5rem; }
    input, select {
      width: 100%; padding: .75rem; border: 1px solid #dcdfe3; border-radius: 10px; margin-top: .35rem;
      font-size: 1rem; background: #fff;
    }
    input[readonly] { background: #f0f0f0; color: #555; cursor: not-allowed; }
    .button-style {
      display: block; width: 100%; text-align: center; padding: 1rem; margin: 16px 0 0;
      font-weight: 800; font-size: 1.1rem; border: none; border-radius: 10px;
      cursor: pointer; text-decoration: none; transition: background-color .25s ease;
    }
    .primary { background: #28a745; color: #ffeb3b; }
    .primary:hover:not([disabled]) { background: #1e7e34; }
    .primary[disabled] { background:#9fcaa9; cursor:not-allowed; }
    .secondary { background: #6c757d; color: #fff; }
    .secondary:hover { background: #5a6268; }
    .summary {
      margin-top: 14px; background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 10px; padding: 12px;
      font-size: .95rem; color: #333;
    }
    .muted { color:#666; font-size:.92rem; }
    .muted.rich { white-space: normal; }
    .pay-wrap {
      display:grid; grid-template-columns: 1fr 1fr; gap:14px;
      margin-top:12px; align-items:stretch;
      background:#fff; border:1px solid #e9ecef; border-radius:10px; padding:12px;
    }
    .pay-col { display:flex; flex-direction:column; justify-content:flex-start; }
    .qr-box { background:#fff; border:1px dashed #cfd6dc; border-radius:10px; padding:10px; text-align:center; }
    .hint { font-size:0.85rem; color:#555; margin-top:4px; }
    .small-note { font-size:0.8rem; color:#555; margin-top:6px; display:block; }
    .hidden { display:none; }
    @media (max-width: 780px) { .row, .pay-wrap { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <div class="box">


    <!-- Logo -->
    <div style="text-align:center; margin-bottom: 10px;">
      <img src="https://junglecubsgyms.com/imgw/logo_light.png"
           alt="Jungle Cubs Gym Logo"
           style="height:80px; width:auto; object-fit:contain;">
    </div>


    <h1>Jungle Cubs Beach Events — Registration</h1>


<!-- Beach Event Preview Video (YouTube) -->
<div style="margin: 10px auto 16px; max-width: 640px;">
  <div style="position: relative; width: 100%; padding-bottom: 56.25%; border-radius: 12px; overflow: hidden;">
    <iframe
      src="https://www.youtube.com/embed/en-luNR_Hrs?autoplay=1&mute=1&controls=0&loop=1&playlist=en-luNR_Hrs&playsinline=1&modestbranding=1&rel=0&showinfo=0"
      frameborder="0"
      allow="autoplay; encrypted-media"
      allowfullscreen
      style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
    ></iframe>
  </div>


  <p style="font-size: 0.9rem; color: #555; margin-top: 4px; text-align: center;">
    A quick glimpse of our Jungle Cubs Beach Events 🌊
  </p>
</div>






    <form id="beachForm" method="post" action="">
      <div class="row">
        <div>
          <label>Parent Name
            <input type="text" name="parentName" id="parentName" required />
          </label>
        </div>
        <div>
          <label>Child Name
            <input type="text" name="childName" id="childName" required />
          </label>
        </div>
      </div>


      <div class="row">
        <div>
          <label>Child DOB
            <input type="date" name="childDOB" id="childDOB" required />
          </label>
        </div>
        <div>
          <label>Child Age (years &amp; months)
            <input type="text" name="childAge" id="childAge" readonly />
          </label>
        </div>
      </div>


      <div class="row">
        <div>
          <label>Location
            <input type="text" name="location" id="location" placeholder="Area / City" required />
          </label>
        </div>
        <div>
          <label>Mobile
            <input type="tel" name="mobile" id="mobile"
                   inputmode="numeric" pattern="^\d{10}$" maxlength="10" minlength="10"
                   placeholder="9812345678" required />
            <span class="small-note">(Will be added to WhatsApp for communication)</span>
          </label>
        </div>
      </div>


      <div class="row">
        <div>
          <label>Are you a Jungle Cubs Gym Parent?
            <select name="status" id="status" required>
              <option value="" selected disabled>-- Select Status --</option>
              <option value="In-house Parent">In-house Parent (Jungle Cubs Gym Parent)</option>
              <option value="Outsider">Outsider (Not a Jungle Cubs Gym Parent)</option>
            </select>
          </label>
        </div>


        <div id="feesWrap" class="hidden">
          <label>Fees Paid Status
            <select name="feesPaid" id="feesPaid">
              <option value="" selected disabled>-- How many months fees paid? --</option>
              <option>Fees Paid for 6 months or more (Complimentary Beach Event)</option>
              <option>Less than 6 months fees paid (Eg: 2/3/4/5 months)</option>
            </select>
          </label>
        </div>
      </div>


      <div class="row">
        <div id="centreWrap" class="hidden">
          <label>Centre
            <select name="centre" id="centre">
              <option value="" selected disabled>-- Select your Centre --</option>
              <option>Hughes Road</option><option>Worli</option><option>Wadala</option><option>Matunga</option>
              <option>Lalbaug</option><option>Chembur</option><option>Ghatkopar</option><option>Powai</option>
              <option>Mulund</option><option>Thane Ram Maruti Road</option><option>Thane Hiranandani Estate</option>
              <option>Bandra</option><option>Malad</option><option>Borivali</option><option>Belapur</option>
            </select>
          </label>
        </div>


        <div>
          <label>Beach Event Date
            <select name="beachEventDate" id="beachEventDate" required>
              <option value="" selected disabled>-- Select Date &amp; Time --</option>
              <option>13th December, Saturday ; 5pm to 6pm ; Ages 2.5 - 6 Years (Juhu)</option>
              <option>14th December, Sunday ; 7:30am to 8:30am ; Ages 2.5 - 6 Years (Juhu)</option>
              <option>20th December, Saturday ; 5pm to 6pm ; Ages 1.5 - 2.5 Years (Juhu)</option>
              <option>21th December, Sunday ; 7:30am to 8:30am ; Ages 2.5 - 6 Years (Girgaon)</option>
            </select>
            <span class="small-note">(Please check Day-Date / Time / Venue &amp; Age Group)</span>
          </label>
        </div>
      </div>


      <!-- Hidden backend fields -->
      <input type="hidden" name="paymentNeeded" id="paymentNeeded" value="Pending" />
      <input type="hidden" name="paid" value="No" />
      <input type="hidden" name="transactionRef" id="transactionRefHidden" value="" />


      <!-- Summary / Payment / Comms (hidden until Status chosen) -->
      <div id="summaryWrap" class="summary hidden">
        <strong>Payment Needed:</strong> <span id="paymentText">—</span>
        <div class="muted rich" id="personalMsg" style="margin-top:6px;"></div>


        <!-- Payment section (shown only when payment is needed) -->
        <div id="paySection" class="hidden" style="margin-top:12px;">
          <div class="muted" style="margin-bottom:8px;">
            Please press the <strong>Pay</strong> button to pay via your UPI app,
            or scan the <strong>QR code</strong> to pay.
          </div>
          <div class="pay-wrap">


            <!-- LEFT: Pay buttons -->
            <div class="pay-col">
              <!-- Google Pay specific FIRST -->
              <a id="gpayButton" class="button-style secondary"
                 href="#"
                 style="background:#0F9D58; margin-bottom:8px;"
                 target="_blank" rel="noopener">
                Pay ₹400 with Google Pay
              </a>
              <span class="small-note">
                Pay via <strong>GPay app</strong> with the button above.
              </span>


              <!-- Generic UPI SECOND -->
              <a id="upiButton" class="button-style secondary"
                 href="#"
                 style="margin-top:14px;"
                 target="_blank" rel="noopener">
                Pay ₹400 via UPI (any app)
              </a>
              <span class="small-note">
                Pay via <strong>other UPI apps</strong> with the button above.
              </span>
            </div>


            <!-- RIGHT: QR -->
            <div class="qr-box">
              <div style="font-weight:600;margin-bottom:6px;">Jungle Cubs Gym UPI QR for ₹400</div>
              <img id="qrImg" src="" alt="UPI QR" style="width:260px;height:260px;object-fit:contain" />
              <div class="hint">Scan to pay ₹400 to Jungle Cubs Gym</div>
            </div>
          </div>


          <!-- Transaction reference below payment options -->
          <div id="txnWrap" style="margin-top:12px;">
            <label>Kindly input your UPI Payment Reference Number (Required after payment)
              <input type="text" id="txnRef" placeholder="e.g. UPI Ref / UTR" />
              <span class="small-note">
                You can also send a payment screenshot on WhatsApp. If sending a screenshot,
                you may write "Photo sent / screenshot sent" in the box above.
              </span>
            </label>
          </div>
        </div>
      </div>


      <button id="registerSendBtn" class="button-style primary" type="button" disabled>
        Register &amp; Send WhatsApp
      </button>
    </form>
  </div>


  <script>
    // ----- CONFIG -----
    const ENDPOINT_URL    = "https://script.google.com/macros/s/AKfycbzH8wt2CymozYbRRWTGW6gsPqwByL_uUNOcd-fRjeGLWkH9gGlj0hLbHgDN7Zz4WNSOYw/exec";
    const BUSINESS_UPI    = "junglecubsgym7@oksbi";
    const BUSINESS_NAME   = "Jungle Cubs";
    const WHATSAPP_TARGET = "919082786189";


    // ----- ELEMENTS -----
    const form          = document.getElementById("beachForm");
    const parentNameEl  = document.getElementById("parentName");
    const childNameEl   = document.getElementById("childName");
    const dobEl         = document.getElementById("childDOB");
    const ageEl         = document.getElementById("childAge");
    const mobileEl      = document.getElementById("mobile");
    const statusEl      = document.getElementById("status");
    const feesWrap      = document.getElementById("feesWrap");
    const feesEl        = document.getElementById("feesPaid");
    const centreWrap    = document.getElementById("centreWrap");
    const centreEl      = document.getElementById("centre");
    const beachDateEl   = document.getElementById("beachEventDate");
    const paymentNeededHidden = document.getElementById("paymentNeeded");
    const summaryWrap   = document.getElementById("summaryWrap");
    const paymentText   = document.getElementById("paymentText");
    const personalMsg   = document.getElementById("personalMsg");
    const paySection    = document.getElementById("paySection");
    const upiButton     = document.getElementById("upiButton");
    const gpayButton    = document.getElementById("gpayButton");
    const qrImg         = document.getElementById("qrImg");
    const txnRefEl      = document.getElementById("txnRef");
    const txnRefHidden  = document.getElementById("transactionRefHidden");
    const registerBtn   = document.getElementById("registerSendBtn");


    // ----- HELPERS -----
    // Mobile: enforce exactly 10 digits
    mobileEl.addEventListener('input', () => {
      mobileEl.value = mobileEl.value.replace(/\D/g,'').slice(0,10);
    });


    // Age: years & months
    dobEl.addEventListener("change", () => {
      if (!dobEl.value) { ageEl.value = ""; return; }
      const dob = new Date(dobEl.value), today = new Date();
      let years = today.getFullYear() - dob.getFullYear();
      let months = today.getMonth() - dob.getMonth();
      if (today.getDate() < dob.getDate()) months -= 1;
      if (months < 0) { years -= 1; months += 12; }
      if (years < 0) { years = 0; months = 0; }
      ageEl.value = `${years} years ${months} months`;
    });


    function computePaymentNeeded(status, feesPaid) {
      const s = (status || "").toLowerCase();
      const f = (feesPaid || "").toLowerCase();
      if (!s) return 'Pending';
      if (s === "outsider") return 'Yes';
      if (s === "in-house parent") {
        if (!f) return 'Pending';
        if (f.includes("less")) return 'Yes';
        if (f.includes("6 months") || f.includes("more")) return 'No';
      }
      return 'Pending';
    }


    function buildUpiLink(amount, parent, child) {
      const tn = `Beach Event fee for ${child || 'child'} - ${parent || 'parent'}`;
      return `upi://pay?pa=${encodeURIComponent(BUSINESS_UPI)}&pn=${encodeURIComponent(BUSINESS_NAME)}&am=${encodeURIComponent(amount)}&cu=INR&tn=${encodeURIComponent(tn)}`;
    }


    function buildQrUrl(upiLink) {
      return `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(upiLink)}`;
    }


    function splitEventLines(eventStr) {
      const clean = (eventStr || '').trim();
      if (!clean) return { dateLine: '', timeLine: '', ageLine: '' };
      const parts = clean.split(';').map(p => p.trim());
      return {
        dateLine: parts[0] || '',
        timeLine: parts[1] || '',
        ageLine:  parts.slice(2).join('; ').trim()
      };
    }


    // WhatsApp text with bold names, nice formatting, footer
    function buildWhatsappText(parent, child, status, need, eventStr, feesPaid, txnRef) {
      const parentClean = (parent || '-').trim();
      const childClean  = (child  || '-').trim();


      const parentB = `*${parentClean}*`;
      const childB  = `*${childClean}*`;


      let statusLabel = status || '';
      const st = (status || '').toLowerCase();


      if (st === 'in-house parent') {
        if (need === 'No')
          statusLabel = 'In-house Parent (6 months + Fees Paid)';
        else
          statusLabel = 'In-house Parent (Fees paid for less than 6 months)';
      } else if (st === 'outsider') {
        statusLabel = 'Outsider (Not Jungle Cubs Gym Parent)';
      }


      const { dateLine, timeLine, ageLine } = splitEventLines(eventStr);


      const lines = [];
      lines.push('🏖️ *Jungle Cubs Beach Event Registration*');
      lines.push('');
      lines.push(`👨‍👩‍👧 Parent: ${parentB}`);
      lines.push(`🧒 Child: ${childB}`);
      if (st === 'outsider') {
        lines.push(`🌱 Status: ${statusLabel}`);
      } else {
        lines.push(`🏫 Status: ${statusLabel}`);
      }
      lines.push('');
      lines.push('📅 Event:');
      if (dateLine) lines.push(dateLine);
      if (timeLine) lines.push(timeLine);
      if (ageLine)  lines.push(ageLine);


      if (st === 'in-house parent' && need === 'No') {
        lines.push('');
        lines.push('💰 Beach Event Payment Needed: *No*');
        lines.push('');
        lines.push(`✨ Thank you, ${parentB}, — enjoy your complimentary beach event with ${childB}.`);
        lines.push('Kindly allow us some time to verify our payment records.');
      } else if (need === 'Yes') {
        lines.push('');
        if (st === 'in-house parent') {
          lines.push('💰 Beach Event Payment Needed: *Yes*');
        } else {
          lines.push('💰 Payment Needed: *Yes (₹400)*');
        }
        lines.push(`🧾 Payment Reference: *${(txnRef || '-').trim()}*`);
        lines.push('');
        lines.push(`✨ Thank you for the payment of ₹400, ${parentB}, — enjoy your beach event with ${childB}.`);


        if (st === 'outsider') {
          lines.push('');
          lines.push('We hope to see you soon at Jungle Cubs Gym!');
        }
      }


      lines.push('');
      lines.push('———');
      lines.push('Follow us on Instagram:');
      lines.push('https://instagram.com/junglecubsgym');
      lines.push('');
      lines.push('Visit us at:');
      lines.push('https://junglecubsgyms.com');


      return lines.join('\n');
    }


    function updatePersonalLine(need) {
      const parent = parentNameEl.value || "Parent";
      const child  = childNameEl.value || "your child";


      if (need === "Yes") {
        personalMsg.innerHTML = `
Hello <strong>${parent}</strong>, kindly pay <strong>₹400</strong> towards the beach event for <strong>${child}</strong>.`;
      } else if (need === "No") {
        personalMsg.innerHTML = `
Hello <strong>${parent}</strong>, enjoy the beach event — you do not have to pay any fees for <strong>${child}</strong>.
<br><br>
<em>Please give us some time to verify the payment records at our end. We will get in touch with you if we need to confirm any details.</em>`;
      } else {
        personalMsg.innerHTML = `Please complete the required selections.`;
      }
    }


    function updateUI() {
      const statusVal = (statusEl.value || "");
      const inHouse   = statusVal === "In-house Parent";


      // Show/hide in-house extras
      const showInHouseExtras = inHouse;
      feesWrap.classList.toggle("hidden", !showInHouseExtras);
      centreWrap.classList.toggle("hidden", !showInHouseExtras);
      feesEl.required  = showInHouseExtras;
      centreEl.required= showInHouseExtras;
      if (!inHouse) { feesEl.value = ""; centreEl.value = ""; }


      // Determine need: Yes / No / Pending
      const need = computePaymentNeeded(statusVal, feesEl.value);
      paymentNeededHidden.value = need;


      if (!statusVal) {
        summaryWrap.classList.add("hidden");
        paySection.classList.add("hidden");
        paymentText.textContent = "—";
        personalMsg.textContent = "";
        registerBtn.disabled = true;
        return;
      }


      summaryWrap.classList.remove("hidden");
      paymentText.textContent = (need === "Yes") ? "Yes (₹400)" : (need === "No" ? "No" : "—");
      updatePersonalLine(need);


      if (need === "Yes" && BUSINESS_UPI && BUSINESS_UPI.includes("@")) {
        const upi = buildUpiLink(400, parentNameEl.value, childNameEl.value);


        // Store UPI for handlers
        upiButton.href = upi;
        upiButton.dataset.upi = upi;
        if (gpayButton) gpayButton.dataset.upi = upi;


        qrImg.src = buildQrUrl(upi);
        qrImg.alt = "UPI QR for ₹400";
        paySection.classList.remove("hidden");
        txnRefEl.required = true;
      } else {
        paySection.classList.add("hidden");
        txnRefEl.required = false;
        txnRefEl.value = "";
        txnRefHidden.value = "";


        upiButton.removeAttribute("data-upi");
        upiButton.href = "#";
        if (gpayButton) gpayButton.removeAttribute("data-upi");
      }


      const formValid = form.checkValidity();
      const txnOk = (need === "Yes") ? !!txnRefEl.value.trim() : (need === "No");
      registerBtn.disabled = !(formValid && (need === "No" || (need === "Yes" && txnOk)));
    }


    // Mirror txn ref to hidden field for backend save
    txnRefEl.addEventListener('input', (e) => {
      txnRefHidden.value = e.target.value.trim();
      updateUI();
    });


    // Re-evaluate on all inputs/selects
    ['change','input','blur'].forEach(evt => {
      document.querySelectorAll('input, select').forEach(el => el.addEventListener(evt, updateUI));
    });


    // Generic UPI button: use intent on Android, direct UPI on others
    if (upiButton) {
      upiButton.addEventListener("click", function (e) {
        const upi = this.dataset.upi;
        if (!upi) return;


        e.preventDefault();


        const ua = navigator.userAgent || "";
        const isAndroid = /Android/i.test(ua);


        if (isAndroid) {
          const withoutScheme = upi.replace(/^upi:\/\//, "");
          const intentUrl = "intent://" + withoutScheme + "#Intent;scheme=upi;end";
          const win = window.open(intentUrl, "_blank");
          if (!win) window.location.href = intentUrl;
        } else {
          const win = window.open(upi, "_blank");
          if (!win) window.location.href = upi;
        }
      });
    }


    // Google Pay–specific button (proper params so GPay shows 400 & Jungle Cubs)
    if (gpayButton) {
      gpayButton.addEventListener("click", function (e) {
        e.preventDefault();


        const parent = parentNameEl.value || "parent";
        const child  = childNameEl.value || "child";


        const upiParams =
          "pa=" + encodeURIComponent(BUSINESS_UPI) +
          "&pn=" + encodeURIComponent(BUSINESS_NAME) +
          "&am=400&cu=INR" +
          "&tn=" + encodeURIComponent("Beach Event fee for " + child);


        const ua = navigator.userAgent || "";
        const isAndroid = /Android/i.test(ua);
        const isIOS    = /iPhone|iPad|iPod/i.test(ua);


        if (isAndroid) {
          const intentUrl =
            "intent://pay?" + upiParams +
            "#Intent;scheme=upi;package=com.google.android.apps.nbu.paisa.user;end";
          const w = window.open(intentUrl, "_blank");
          if (!w) window.location.href = intentUrl;
        } else if (isIOS) {
          const iosUrl = "gpay://upi/pay?" + upiParams;
          const w = window.open(iosUrl, "_blank");
          if (!w) window.location.href = iosUrl;
        } else {
          const upi = "upi://pay?" + upiParams;
          const w = window.open(upi, "_blank");
          if (!w) window.location.href = upi;
        }
      });
    }


    // Main unified button: build WA text, open WA, then submit
    registerBtn.addEventListener('click', () => {
      const need = paymentNeededHidden.value;
      if (!form.checkValidity()) { form.reportValidity(); return; }
      if (need === 'Yes' && !txnRefEl.value.trim()) { txnRefEl.reportValidity(); return; }


      const waText = buildWhatsappText(
        parentNameEl.value, childNameEl.value,
        statusEl.value, need, beachDateEl.value,
        feesEl.value, txnRefEl.value.trim()
      );
      const waUrl = `https://wa.me/${WHATSAPP_TARGET}?text=${encodeURIComponent(waText)}`;


      window.open(waUrl, '_blank', 'noopener');
      form.action = ENDPOINT_URL;
      form.submit();
    });


    // Init
    updateUI();
    if (dobEl.value) dobEl.dispatchEvent(new Event('change'));
  </script>
</body>
</html>